---
title: "Data Summary: Automatic Feeder Survey Data"
author: "Kota Minegishi"
date: "Created: April 18, 2017"
output: 
  html_notebook:
    toc: true
    toc_depth: 2
    number_sections: true
---


<style> div.main-container { max-width: 1050px; } </style> 


# Objective

* Summarize and explore survey records

# Data 

* Questionnaire on automated calf feeders and associated group housing facilities, for project cooperator dairy operations. 

* Collected and maintained by Marcia Endres, Bill Lazarus, and Matt Jorgensen. 


```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
library(lazyeval)
load("survey_data.RData")
```


To manage data, *variables* are created for survey questions, which are separated from the survey data. The question-variable key table is the following;   
```{r}
question_key %>% 
  mutate(
    question = substr(question, 1, 75)
  )
```


The survey data are split into `survey_current` (e.g., farm id = 1, 2, ...) and  `survey_current` (e.g., farm id = "1 long term", "4 long term", etc., which are answers with respect to farms' future plans). 

`survey_current` has `r nrow(survey_current)` observations and `r ncol(survey_current)` variables;
```{r}
summary(survey_current)
```


Similarly, `survey_planned` has `r nrow(survey_planned)` observations and `r ncol(survey_planned)` variables; many variables are missing.

 
# Data plots

Unless we impute missing information, there are not many data points. It also appears that these farms may not raise calves primarily for profit from calf sales. In that case, we may not see much economic explanation for varying practices across farms.  

## Value of calf after being fed

So far the most interesting plot is the one with the **values of a calf coming in** and **going out** of the feeding operation. 

```{r}
survey_current %>%
  ggplot(aes(x = value_calf_in, y = value_calf_out)) +
  geom_point() +
  geom_smooth(method="lm")
```

However, the final (expected) calf price does not seem to be correlated with the costs of capital investment, labor, repairs, and feed ingredients.  

```{r}
survey_current %>%
  ggplot(aes(x = exper_mons, y = value_calf_out)) +
  geom_point()

survey_current %>%
  ggplot(aes(x = calves_total, y = value_calf_out)) +
  geom_point()

survey_current %>%
  filter(capital_cost_calf < 100) %>%
  ggplot(aes(x = capital_cost_calf, y = value_calf_out)) +
  geom_point() 

survey_current %>%
  ggplot(aes(x = labor_calf, y = value_calf_out )) +
  geom_point() 

survey_current %>%
  ggplot(aes(x = repair_calf, y = value_calf_out )) +
  geom_point() 

survey_current %>%
  ggplot(aes(x = feed_hd, y = value_calf_out)) +
  geom_point() 

survey_current %>%
  filter(bedding_hd < 50) %>%
  ggplot(aes(x = bedding_hd, y = value_calf_out)) +
  geom_point() 

```

## Mortality 

No obvious patterns are found in the mortality rate across farms.

```{r}

survey_current %>%
  ggplot(aes(x = exper_mons, y = mortality)) +
  geom_point() 


survey_current %>%
  ggplot(aes(x = num_calves, y = mortality)) +
  geom_point() 


survey_current %>%
  filter(capital_cost_calf < 100) %>%
  ggplot(aes(x = capital_cost_calf, y = mortality)) +
  geom_point() 


survey_current %>%
  ggplot(aes(x = feed_hd, y = mortality)) +
  geom_point() 

survey_current %>%
  filter(bedding_hd < 50) %>%
  ggplot(aes(x = bedding_hd, y = mortality)) +
  geom_point() 

survey_current %>%
  ggplot(aes(x = repair_calf, y = mortality)) +
  geom_point() 

survey_current %>%
  ggplot(aes(x = labor_calf, y = mortality)) +
  geom_point() 

```


## Labor and Capital

Some have invested more on the system than others. Higher capital cost, however, does not seem to be related to higher labor efficiency or lower mortality. (Probably it has to do with the cost of remodeling the barn etc.) 

```{r}
survey_current %>%
  filter(capital_cost_calf < 100) %>%
  ggplot(aes(x = labor_calf, y = capital_cost_calf)) +
  geom_point(aes(color = exper_mons))

survey_current %>%
  filter(capital_cost_calf < 100) %>%
  ggplot(aes(x = labor_calf, y = capital_cost_calf)) +
  geom_point(aes(color = calves_gr))

survey_current %>%
  filter(capital_cost_calf < 100) %>%
  ggplot(aes(x = labor_calf, y = capital_cost_calf)) +
  geom_point(aes(color = mortality_gr))

survey_current %>%
  filter(capital_cost_calf < 100) %>%
  ggplot(aes(x = labor_calf, y = capital_cost_calf)) +
  geom_point(aes(color = labor_calf))
```



